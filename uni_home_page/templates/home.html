{# AUTO-YORUMLU SÜRÜM – orijinal dosya kesilmeden korunmuştur #}
{# base.html şablonunu miras alır (nav/footer/tema vb.) #}
{% extends 'base.html' %}
{# static etiketi: home.css gibi statik dosyaları çağırmak için #}
{% load static %}

{# Sayfa başlığı: tarayıcı sekmesinde görünür #}
{% block title %}UniNews // LIVE CAMPUS{% endblock %}

{# Üstteki cmd/hint satırında görünen kısa rota etiketi #}
{% block page_hint %}home/live{% endblock %}

{# Bu sayfaya özel CSS dosyası (home.css) #}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/home.css' %}">
{% endblock %}

{# Sayfanın ana içerik bloğu: 3 kolonlu Live Campus grid #}
{% block content %}

<!-- 3 kolonlu ana grid: Sol (feed/tags) + Orta (stream) + Sağ (AI/quick) -->
<div class="lc-grid">

<!-- Sol panel: statik live feed + trend tag'ler -->
  <!-- LEFT: LIVE FEED -->
  <aside class="lc-left">
    <div class="lc-panel lc-feed">
      <div class="lc-panel-head">
        <div class="lc-head-title">
          <i class="bi bi-broadcast"></i>
          <span class="lc-mono">LIVE FEED</span>
        </div>
        <span class="lc-badge">now</span>
      </div>

      <div class="lc-feed-list">
        <div class="lc-feed-item hot">
          <div class="t">AZ ÖNCE</div>
          <div class="m">Final sınav takvimi güncellendi</div>
          <div class="s">Öğrenci İşleri • 2 dk önce</div>
        </div>

        <div class="lc-feed-item">
          <div class="t">12:30</div>
          <div class="m">Kütüphane yoğunluğu arttı</div>
          <div class="s">Kampüs • bugün</div>
        </div>

        <div class="lc-feed-item">
          <div class="t">11:10</div>
          <div class="m">Robotik kulübü yeni üyeler arıyor</div>
          <div class="s">Kulüpler • bugün</div>
        </div>

        <div class="lc-feed-item">
          <div class="t">Dün</div>
          <div class="m">Kariyer Günleri başvuruları açıldı</div>
          <div class="s">Kariyer • dün</div>
        </div>

        <div class="lc-feed-item dim">
          <div class="t">Log</div>
          <div class="m">Sistem kararlı. Yayın akışı izleniyor…</div>
          <div class="s">uninews://monitor</div>
        </div>
      </div>

      <div class="lc-panel-foot">
        <span class="lc-muted">İpucu:</span> sağdaki AI’ye “bugün kampüste ne var?” yaz.
      </div>
    </div>

    <div class="lc-panel lc-tags">
      <div class="lc-panel-head">
        <div class="lc-head-title">
          <i class="bi bi-hash"></i>
          <span class="lc-mono">TREND TAGS</span>
        </div>
      </div>

      <div class="lc-chip-wrap">
        <a class="lc-chip" href="#">#burs</a>
        <a class="lc-chip" href="#">#erasmus</a>
        <a class="lc-chip" href="#">#yazokulu</a>
        <a class="lc-chip" href="#">#gönüllülük</a>
        <a class="lc-chip" href="#">#girişimcilik</a>
        <a class="lc-chip" href="#">#sporturnuvası</a>
      </div>
    </div>
  </aside>


<!-- Orta panel: focus/hero + posts stream (posts queryset'i) -->
  <!-- CENTER: FOCUS + STREAM -->
  <section class="lc-main">

    <!-- FOCUS PANEL (hero yerine OS ekranı gibi) -->
    <article class="lc-panel lc-focus">
      <div class="lc-focus-top">
        <span class="lc-focus-kicker lc-mono">UNINEWS // LIVE CAMPUS</span>
        <span class="lc-focus-pill">
          <i class="bi bi-shield-check"></i> doğrulanmış kampüs akışı
        </span>
      </div>

      <h1 class="lc-focus-title">
        Kampüs <span class="neo">gerçek zamanlı</span> akıyor.
      </h1>

      <p class="lc-focus-desc">
        Haberler, duyurular ve etkinlikler tek ekranda.
        Sağdaki UniNews AI’ye sor — “özetle”, “planla”, “öne çıkar”.
      </p>

      <div class="lc-focus-actions">
        <a class="lc-btn" href="{% url 'gundem' %}">
          <i class="bi bi-lightning-charge"></i> Gündeme git
        </a>
        <a class="lc-btn ghost" href="{% url 'etkinlikler' %}">
          <i class="bi bi-calendar-event"></i> Etkinlikleri aç
        </a>
      </div>

      <div class="lc-focus-meter">
        <div class="m-label lc-mono">KAMPÜS PULSE</div>
        <div class="m-bar"><span></span></div>
        <div class="m-sub">yüksek aktivite • son 24 saat</div>
      </div>
    </article>

    <!-- STREAM -->
    <div class="lc-stream-head">
      <div class="lc-stream-title">
        <i class="bi bi-stack"></i>
        <span class="lc-mono">STREAM</span>
      </div>
      <div class="lc-stream-hint lc-muted">en yeni gönderiler</div>
    </div>

{# posts: view'den gelen onaylı gönderiler listesi #}
    {% for post in posts %}
      <article class="lc-post">
        <a class="lc-post-media" href="{% url 'post_detail' post.pk %}">
{# Kapak görseli varsa cover.url kullanılır; yoksa placeholder (picsum) kullanılır #}
          {% if post.cover %}
{# Kapak görseli varsa cover.url kullanılır; yoksa placeholder (picsum) kullanılır #}
            <img src="{{ post.cover.url }}" alt="">
          {% else %}
            <img src="https://picsum.photos/seed/gundem{{ post.pk }}/900/450" alt="">
          {% endif %}
          <span class="lc-post-chip">GÜNDEM</span>
        </a>

        <div class="lc-post-body">
          <div class="lc-post-meta">
            <span class="lc-meta-left">
              <i class="bi bi-calendar3"></i> {{ post.created_at|date:"d.m.Y" }}
              <span class="dot">•</span>
              <i class="bi bi-clock"></i> {{ post.created_at|date:"H:i" }}
            </span>

            <span class="lc-meta-right">
              <i class="bi bi-person-badge"></i> @{{ post.author.username }}
              <span class="role">
                {% if post.author.is_staff %}Onaylı{% else %}Üye{% endif %}
              </span>
            </span>
          </div>

          <h2 class="lc-post-title">
            <a href="{% url 'post_detail' post.pk %}">{{ post.title }}</a>
          </h2>

          <p class="lc-post-desc">
{# İçerik kısaltma: kartta uzun metin taşmasın diye #}
            {{ post.content|truncatechars:170 }}
          </p>

          <div class="lc-post-foot">
            <div class="lc-post-stats">
              <span><i class="bi bi-eye"></i> {{ post.views.count }}</span>
              <span><i class="bi bi-heart"></i> {{ post.likes.count }}</span>
              <span><i class="bi bi-chat"></i> {{ post.comments.count }}</span>
            </div>

            <a class="lc-post-read" href="{% url 'post_detail' post.pk %}">
              okumaya devam <i class="bi bi-arrow-right-short"></i>
            </a>
          </div>
        </div>
      </article>

    {% empty %}
      <div class="lc-panel lc-empty">
        Henüz gündem içeriği yok.
      </div>
    {% endfor %}

  </section>


<!-- Sağ panel: AI konsol (form + history) ve quick liste -->
  <!-- RIGHT: AI CONSOLE + QUICK LISTS -->
  <aside class="lc-right">

    <!-- AI CONSOLE (senin AI formunu bozmadım, sadece görünüm değişti) -->
    <div class="lc-panel lc-ai">
      <div class="lc-panel-head">
        <div class="lc-head-title">
          <i class="bi bi-cpu"></i>
          <span class="lc-mono">UNINEWS AI</span>
        </div>

{# AI geçmişini temizleme: clear_ai_history view'i #}
        <form method="post" action="{% url 'clear_ai_history' %}">
          {% csrf_token %}
          <button class="lc-mini-btn" type="submit" title="Geçmişi temizle">
            <i class="bi bi-trash3"></i>
          </button>
        </form>
      </div>

      <div class="lc-ai-sub">Komut yaz: <span class="lc-mono">özetle</span>, <span class="lc-mono">planla</span>, <span class="lc-mono">öne çıkar</span></div>

      <form method="post" class="lc-ai-form">
        {% csrf_token %}
        <div class="lc-ai-input">
{# AI soru input'u: form.question field render edilir #}
          {{ form.question }}
        </div>
        <button class="lc-btn mini" type="submit">
          <i class="bi bi-send"></i> Sor
        </button>
      </form>

      <div class="lc-ai-log">
        {% for m in history %}
          <div class="lc-ai-item">
            <div class="q"><span class="lc-mono">&gt;</span> {{ m.question }}</div>
            <div class="a">{{ m.answer }}</div>
            <div class="t">{{ m.created_at }}</div>
          </div>
        {% empty %}
          <div class="lc-ai-empty">
            <span class="lc-mono">&gt;</span> Henüz komut yok. “bugün kampüste ne var?” dene.
          </div>
        {% endfor %}
      </div>
    </div>

    <div class="lc-panel lc-quick">
      <div class="lc-panel-head">
        <div class="lc-head-title">
          <i class="bi bi-megaphone"></i>
          <span class="lc-mono">QUICK</span>
        </div>
      </div>

      <ul class="lc-list">
        <li><span class="k">Duyuru</span> Yaz okulu kayıtları 1 Haziran’da başlıyor.</li>
        <li><span class="k">Duyuru</span> Teknofest proje başvuruları devam ediyor.</li>
        <li><span class="k">Popüler</span> Kariyer Günleri’ne rekor katılım.</li>
      </ul>
    </div>

  </aside>

</div>

{% endblock %}
